<!DOCTYPE html>
<html>
<head>
 <meta charset="UTF-8">
 <title>Offset complex cube</title>
 <link rel="stylesheet" href="../css/MAS290.css">
 <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"> 
   MathJax.Hub.Config({
     extensions: ["tex2jax.js"],
     jax: ["input/TeX","output/HTML-CSS"],
     tex2jax: {inlineMath: [["$","$"]]}
   });
 </script> 
 <script type="text/javascript" src="../js/paperjs/paper.js"></script>
 <script type="text/javascript" src="../js/ode.js"></script>
 <script type="text/paperscript" canvas="canvas">

var ODE = ode.create();

ODE.x_min   = -2.3;
ODE.x_max   = 2.3;
ODE.y_min   = -2.3;
ODE.y_max   = 2.3;
ODE.x_scale = 100;
ODE.y_scale = 100;
ODE.t_scale = 1;

ODE.view_type = 'disc';
ODE.view_radius = 2.3;
ODE.display_digits = 4;


ODE.update_walker = function(w,dt) {
 var x0 = w.x;
var y0 = w.y;
var dx = (Math.pow(x0, 0.3e1) - 0.3e1 * x0 * Math.pow(y0, 0.2e1) - 0.1e1) * dt + (Math.pow(x0, 0.3e1) - 0.3e1 * x0 * Math.pow(y0, 0.2e1) - 0.1e1) * (0.3e1 * Math.pow(x0, 0.2e1) - 0.3e1 * Math.pow(y0, 0.2e1)) * Math.pow(dt, 0.2e1) / 0.2e1 - 0.3e1 * (0.3e1 * Math.pow(x0, 0.2e1) * y0 - Math.pow(y0, 0.3e1)) * x0 * y0 * Math.pow(dt, 0.2e1);
var dy = (0.3e1 * Math.pow(x0, 0.2e1) * y0 - Math.pow(y0, 0.3e1)) * dt + (0.3e1 * Math.pow(x0, 0.2e1) * y0 - Math.pow(y0, 0.3e1)) * (0.3e1 * Math.pow(x0, 0.2e1) - 0.3e1 * Math.pow(y0, 0.2e1)) * Math.pow(dt, 0.2e1) / 0.2e1 + 0.3e1 * (Math.pow(x0, 0.3e1) - 0.3e1 * x0 * Math.pow(y0, 0.2e1) - 0.1e1) * x0 * y0 * Math.pow(dt, 0.2e1);
this.translate_walker(w,dx,dy,dt);
};

var L = Object.create(ODE);

L.create_group();
L.create_walker();
L.fetch_lines('complex_cube_offset_lines.json');
L.set_display();

function onFrame(event)     { L.on_frame(event);      }
function onMouseDown(event) { L.on_mouse_down(event); }

 </script>
</head>
<body>
<table>
 <tr>
  <td class="command" width="100" onclick="location='../index.html'">Home</td>
  <td class="command" width="200" onclick="location='index.html'">List of phase portraits</td>
  
 </tr>
</table>
<br/>
<h1>Offset complex cube</h1>
<table>
 <tr>
  <td>
   <canvas id="canvas" width="500" height="500"></canvas>
  </td>
  <td valign="top">
  \begin{align*}
 \dot{x} &= {x}^{3}-3\,x{y}^{2}-1 \\
 \dot{y} &= 3\,{x}^{2}y-{y}^{3} 
\end{align*}

   <br/><br/><br/><br/>
      <table>
    <tr>
     <td>$x=$</td>
     <td align="right"><span id="display_x"></span></td>
    </tr>
    <tr>
     <td>$y=$</td>
     <td align="right"><span id="display_y"></span></td>
    </tr>
    <tr>
     <td>$\dot{x}=$</td>
     <td align="right"><span id="display_x_dot"></span></td>
    </tr>
    <tr>
     <td>$\dot{y}=$</td>
     <td align="right"><span id="display_y_dot"></span></td>
    </tr>
   </table>

  </td>
 </tr>
</table>

<div style="width:800px">
 It is best to understand these equations using the complex variable
 $z=x+iy$, so $x=\text{Re}(z)$ and $y=\text{Im}(z)$.  We have
 \begin{align*}
  \dot{x} &= x^3-3xy^2-1 = \text{Re}(z^3-1) \\
  \dot{y} &= 3x^2y-y^3 = \text{Im}(z^3-1) \\
  \dot{z} &= z^3-1 = x^3 + 3x^2yi - 3xy^2 - y^3i.
 \end{align*}
 To understand the nullclines, it is useful to consider the number 
 $$ \omega = e^{2\pi i/3} = (\sqrt{3}i-1)/2, $$ 
 and to note that $\omega^3=1$, so that $(\omega z)^3-1=z^3-1$.  The
 point $\omega z$ is obtained by rotating the point $z$ through an
 angle of $2\pi/3$ around the origin.
 <br/><br/>
 The $y$-nullcline consists of points $z\in\mathbb{C}$ where 
 $z^3-1$ is real, or equivalently $z^3$ is real, or equivalently $z$
 is real or is a real multiple of $\omega$ or $\overline{\omega}$.
 Thus, the $y$-nullcline consists of three straight lines through the
 origin.
 <br/><br/>
 The $x$-nullcline consists of points $z$ where $z^3-1$ is purely
 imaginary, say $z^3=1+is$ for some $s\in\mathbb{R}$.  This means that
 $z$ is $(1+is)^{1/3}$ or $\omega(1+is)^{1/3}$ or
 $\overline{\omega}(1+is)^{1/3}$. 
 <br/><br/>
 The equilibrium points are the points $z$ where $z^3=1$, which are
 $1$, $\omega$ and $\overline{\omega}$.

</div>
</body>
</html>
